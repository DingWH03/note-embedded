# 网络与现场总线（Networking/Fieldbus）

网络与现场总线的核心目的，是把控制器、远端 I/O、传感器与执行器在**米级到千米级**范围内可靠联结起来，为**周期性控制与事件驱动通信**提供可预见的带宽、延迟与抖动，同时抵御工业与车载环境中的噪声、震动、温漂与电磁干扰。相较于板级外设与存储/主机接口，这一类更强调**多节点协同、确定性与可维护性**，承担系统的“**控制域数据平面**”与“**设备管理面**”。

这类网络通常运行在**受控拓扑**上：星形、线形/总线、环形或树形级联；节点数从少量设备到整条产线/整车域都可扩展。通信模型既支持**周期性循环 I/O**（把输入采样与输出刷新锁定在固定节拍内），也支持**非周期参数/诊断**（配置、告警、日志）。为了在规模化下仍然可预期，系统会引入**地址与命名、时间同步、调度与整形、优先级与流控**等机制，把关键流量与背景流量隔离开来。

**确定性**是关键词。典型做法是通过**网络对时**（硬件时间戳、基准时钟分发）与**调度/整形**（时间窗、信用/令牌、守门器）来收紧端到端抖动；对闭环控制，还会限定**最坏情况传输时延**与**迟到/丢帧处置策略**，以确保控制周期不被拖长。与此相配合，交换/转发设备提供**排队与整形队列**、入/出端口**速率限制**与**拥塞标记**，在高负载下维持可用性与公平性。

电气层面更注重**差分传输、屏蔽与隔离**。从单对双绞线到多对铜缆、到光纤与无线回传，链路选择取决于距离、带宽与工况；常见的**磁隔离/数字隔离**与**接地/屏蔽端接**策略可抑制共模干扰与地环路；在某些应用中，**数据线上叠加供电**降低布线复杂度。对长距离与线束复杂场景，链路会采用**自适应均衡、预加重、纠错与重传**以维持误码率。

可靠性与安全性方面，网络通常提供**冗余路径与快速收敛**（环网保护、双归属、故障切换）以抵御单点失效；在设备层引入**健康监测与自检**（链路质量、迟到/重传统计、温度/电源告警）以便预测性维护。面向功能安全的场合，会在通用通信之上叠加**安全层**（黑通道思路、序列/超时/端到端校验），以满足系统级安全完整性等级目标。对信息安全，则通过**设备身份、访问控制、分区与加密**保护控制域不被越权访问。

软件集成强调**可预期与可运维**：实时系统/PLC/域控制器对周期任务进行**固定节拍调度**，I/O 映射与过程数据通过**共享内存/零拷贝**进出应用；非周期流量走**低优先级通道**避免打断关键循环。工程部署依赖**设备描述/对象模型**实现即插即用与跨厂商互操作；调试与运维使用**抓包/时延与抖动测量、拓扑发现、链路健康仪表板**定位瓶颈与隐患，并以**版本/参数基线**管理变更。

从演进路径看，现场总线正向**以太网化与融合化**发展：一方面把确定性机制引入通用网络，实现**控制流与数据流并存**；另一方面通过**网关/边缘节点**把历史遗留总线整合到统一的管理与数据平台。取舍的本质，仍是在**确定性、带宽、距离、供电、EMC、成本与可维护性**之间达成平衡：既要让关键控制链路“**准时**且**不中断**”，也要让整网在扩展、升级与运维上保持“**可管**且**可演进**”。

## 1. 常见网络与现场总线

**Ethernet** 是最常见的通用通信接口，速率范围覆盖 10 Mbps–10 Gbps，典型应用于星型/交换拓扑。其优点是生态成熟、带宽高，但实时性不足，在车载与工业控制中需结合 TSN 扩展以满足确定性需求。

**SPE**（Single Pair Ethernet）采用单对线传输，速率 10 Mbps，可支持 25 m 多点或 1 km 点到点连接，同时具备供电能力。结合 TSN 时可实现确定性通信，常用于汽车与工业短距互联。

**车载以太网**（100/1000BASE-T1）是专为车辆设计的点到点链路，速率可达 1 Gbps，支持轻量化布线和高带宽通信，配合 TSN 用作车内骨干网络。

**TSN**（Time-Sensitive Networking）是 IEEE 802.1 标准族，包含时间同步（802.1AS）、时隙调度（802.1Qbv）等机制，能够保障低延迟与确定性传输，适合工业自动化、智能电网和车载实时通信。

**CAN** 总线是汽车与工业的基础通信方式，速率可达 1 Mbps（CAN FD 可达数 Mbps），支持多节点总线拓扑，具备软实时能力，常用于车身与控制器通信。

**LIN** 总线速率约 20 kbps，采用单主多从架构，成本低但实时性有限，常见于车窗、座椅等低速外设控制。

**FlexRay** 提供 10 Mbps 的高速差分通信，支持星型或总线拓扑，具备冗余与硬实时能力，常用于线控底盘和动力总成系统。

**工业以太网**（如 EtherCAT、PROFINET）基于以太网物理层改造，支持子毫秒级实时通信和确定性调度，适合运动控制、PLC 与高精度工业自动化。

## 2. 典型对照表

### (1)以太网与 TSN

| 技术                              |      速率 |          距离 | 拓扑     | 实时性        | 备注           |
| ------------------------------- | ------: | ----------: | ------ | ---------- | ------------ |
| Ethernet (10M/100M/1G/2.5G/10G) | 10M–10G |    100 m(铜) | 星/交换   | 非确定        | FCS 校验、交换机转发 |
| SPE 10BASE‑T1S/T1L              | 10 Mbps | 25 m / 1 km | 多点/点到点 | 可确定(配 TSN) | 单对线、可叠加供电    |
| 100/1000BASE‑T1                 | 100M/1G |     15–40 m | 点到点    | 配 TSN      | 车载骨干         |
| TSN (802.1AS/Qbv/等)             |       — |           — | —      | **确定性**    | 时间同步/时隙调度    |

### (1)汽车/工业总线

| 协议                         | 物理  |      速率 |       距离 | 拓扑   | 实时性     | 用途       |
| -------------------------- | --- | ------: | -------: | ---- | ------- | -------- |
| CAN 2.0 / FD               | 差分  | 1M / 数M | 数十\~数百 m | 总线   | 软实时     | 车身/工业控制  |
| LIN                        | 单端  | 20 kbps |   \~40 m | 一主多从 | 松实时     | 低成本节点    |
| FlexRay                    | 差分  | 10 Mbps |   \~24 m | 星/总线 | **硬实时** | 线控底盘     |
| 工业以太网（EtherCAT/PROFINET 等） | 以太网 |  子 ms 级 |      网段级 | 星/线形 | 硬/确定    | 运动控制/PLC |